<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Efficient Fine-Grained Guidance for Diffusion-Based Symbolic Music Generation</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .authors, .links {
            text-align: center;
            margin: 10px 0;
        }
        .demo-link {
            text-align: center;
            margin: 20px 0;
        }
        .demo-link a {
            display: inline-block;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
        }
        .demo-link a:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Efficient Fine-Grained Guidance for Diffusion Model Based Symbolic Music Generation</h1>
            <p class="authors">Tingyu Zhu<sup>*</sup>, Haoyu Liu<sup>*</sup>, Ziyu Wang, Zhimin Jiang, Zeyu Zheng</p>
            <p class="links">
                <a href="https://arxiv.org/abs/2410.08435">[Paper]</a>
                <a href="https://github.com/huajianduzhuo-code/FGG-music-code">[Code Repo]</a>
            </p>
            <p class="intro">
                We introduce <strong>Fine-Grained Guidance (FGG)</strong>, an efficient approach for symbolic music generation using <strong>diffusion models</strong>. Our method enhances guidance through:
                <br>&emsp; (1) Fine-grained conditioning during training,
                <br>&emsp; (2) Fine-grained control during the diffusion sampling process.
                <br>In particular, <strong>sampling control</strong> ensures tonal accuracy in every generated sample, allowing our model to produce music with high precision, consistent rhythmic patterns, and even stylistic variations that align with user intent.
            </p>
        </header>

        <section id="accompaniment-generation">
            <h2>1. Accompaniment Generation given Melody and Chord</h2>
            <p>We provide the model with the melody and chord as inputs, and the model will generate the accompaniment accordingly.</p>
            <p>In each example, the left column displays the melody provided as inputs to the model. The right column showcases music samples generated by the model. The score for the melody and accompaniment are provided in section 4.</p>

            <div class="example-section">
                <div class="example-box">
                    <h3>Example 1</h3>
                    <div class="example-content">
                        <div class="melody">
                            <h4>With the following melody as condition</h4>
                            <audio controls>
                                <source src="samples/diy_examples/example1/example_1_mel.wav" type="audio/wav">
                            </audio>
                        </div>
                        <div class="generated">
                            <h4>Generated Accompaniments</h4>
                            <audio controls>
                                <source src="samples/diy_examples/example1/sample1.wav" type="audio/wav">
                            </audio>
                        </div>
                    </div>
                </div>

                <div class="example-box alt">
                    <h3>Example 2</h3>
                    <div class="example-content">
                        <div class="melody">
                            <h4>With the following melody as condition</h4>
                            <audio controls>
                                <source src="samples/diy_examples/example2/example_2_mel.wav" type="audio/wav">
                            </audio>
                        </div>
                        <div class="generated">
                            <h4>Generated Accompaniments</h4>
                            <audio controls>
                                <source src="samples/diy_examples/example2/sample1.wav" type="audio/wav">
                            </audio>
                        </div>
                    </div>
                </div>

                <div class="example-box">
                    <h3>Example 3</h3>
                    <div class="example-content">
                        <div class="melody">
                            <h4>With the following melody as condition</h4>
                            <audio controls>
                                <source src="samples/diy_examples/example3/example_3_mel.wav" type="audio/wav">
                            </audio>
                        </div>
                        <div class="generated">
                            <h4>Generated Accompaniments</h4>
                            <audio controls>
                                <source src="samples/diy_examples/example3/sample1.wav" type="audio/wav">
                            </audio>
                        </div>
                    </div>
                </div>

                <div class="example-box alt">
                    <h3>Example 4</h3>
                    <div class="example-content">
                        <div class="melody">
                            <h4>With the following melody as condition</h4>
                            <audio controls>
                                <source src="samples/diy_examples/example4/example_4_mel.wav" type="audio/wav">
                            </audio>
                        </div>
                        <div class="generated">
                            <h4>Generated Accompaniments</h4>
                            <audio controls>
                                <source src="samples/diy_examples/example4/sample1.wav" type="audio/wav">
                            </audio>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="style-controlled">
            <h2>2. Style-Controlled Music Generation</h2>
            <p>Our approach enables controllable stylization in music generation. The sampling control is able to ensure that all generated notes strictly adhere to the target musical style's scale. This allows the model to generate music in specific styles — even those that were not present in the training data.</p>
            <p>Below, we demonstrate several examples of style-controlled music generation for:</p>
            <ul>
                <li>Dorian Mode: (with scale being A-B-C-D-E-F#-G)</li>
                <li>Chinese Style: (with scale being C-D-E-G-A)</li>
            </ul>

            <div class="style-section">
                <div class="style-box">
                    <h3>Dorian Mode</h3>
                    <p>The following are two examples generated by our method</p>
                    <div class="style-examples">
                        <div class="style-example">
                            <h4>Example 1</h4>
                            <audio controls>
                                <source src="samples/different_styles/dorian_1.wav" type="audio/wav">
                            </audio>
                        </div>
                        <div class="style-example">
                            <h4>Example 2</h4>
                            <audio controls>
                                <source src="samples/different_styles/dorian_2.wav" type="audio/wav">
                            </audio>
                        </div>
                    </div>
                </div>

                <div class="style-box alt">
                    <h3>Chinese Style</h3>
                    <p>The following are two examples generated by our method</p>
                    <div class="style-examples">
                        <div class="style-example">
                            <h4>Example 1</h4>
                            <audio controls>
                                <source src="samples/different_styles/chinese_1.wav" type="audio/wav">
                            </audio>
                        </div>
                        <div class="style-example">
                            <h4>Example 2</h4>
                            <audio controls>
                                <source src="samples/different_styles/chinese_2.wav" type="audio/wav">
                            </audio>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="comparison">
            <h2>3. Demonstrating the Effectiveness of Our Proposed Method by Comparison</h2>
            <p>We demonstrate the impact of sampling control in an <strong>accompaniment generation</strong> task, given a melody and chord progression. Each example generates accompaniments using the same random seed (but different ablative conditions), ensuring that the results are comparable.</p>

            <div class="ablation-section">
                <p>The ablative conditions are as follows:</p>
                <ol>
                    <li>Only Training Control</li>
                    <li>Training Control + Remove Out-of-Key Notes at the last step</li>
                    <li>Training Control + Round Out-of-Key Notes to the Nearest allowable note at the last step</li>
                    <li>Inpainting Method</li>
                </ol>

                <p>Comparison of the results indicates that sampling control not only eliminates out-of-key notes but also enhances the overall coherence and harmonic consistency of the accompaniments. This highlights the effectiveness of our approach in maintaining musical coherence.</p>

                <div class="comparison-examples">
                    <div class="comparison-box">
                        <h3>Example 1</h3>
                        <div class="comparison-content">
                            <div class="input-section">
                                <h4>With pre-defined melody and chord as follows</h4>
                                <div class="sheet-music">
                                    <img src="samples/ablation/melody_1.jpg" alt="Music Sheet of Melody and Chord">
                                </div>
                                <div class="melody-audio">
                                    <audio controls>
                                        <source src="samples/ablation/sample_1_melody.wav" type="audio/wav">
                                    </audio>
                                </div>
                            </div>
                            <div class="generated-section">
                                <h4>Generated Accompaniments from Different Ablative Conditions</h4>
                                <div class="ablative-examples">
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_1_control_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p class="highlight">Training Control + Sampling Control (our proposed method)</p>
                                    </div>
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_1_uncontrol_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p>Only Training Control</p>
                                    </div>
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_1_last_step_control_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p>Training Control + Remove Out-of-Key Notes</p>
                                    </div>
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_1_last_step_rounding_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p>Training Control + Round Out-of-Key Notes to Nearest</p>
                                    </div>
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_1_inpainting_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p>Inpainting Method</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="comparison-box alt">
                        <h3>Example 2</h3>
                        <div class="comparison-content">
                            <div class="input-section">
                                <h4>With pre-defined melody and chord as follows</h4>
                                <div class="sheet-music">
                                    <img src="samples/ablation/melody_2.jpg" alt="Music Sheet of Melody and Chord">
                                </div>
                                <div class="melody-audio">
                                    <audio controls>
                                        <source src="samples/ablation/sample_2_melody.wav" type="audio/wav">
                                    </audio>
                                </div>
                            </div>
                            <div class="generated-section">
                                <h4>Generated Accompaniments from Different Ablative Conditions</h4>
                                <div class="ablative-examples">
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_2_control_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p class="highlight">Training Control + Sampling Control (our proposed method)</p>
                                    </div>
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_2_uncontrol_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p>Only Training Control</p>
                                    </div>
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_2_last_step_control_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p>Training Control + Remove Out-of-Key Notes</p>
                                    </div>
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_2_last_step_rounding_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p>Training Control + Round Out-of-Key Notes to Nearest</p>
                                    </div>
                                    <div class="ablative-example">
                                        <audio controls>
                                            <source src="samples/ablation/sample_2_inpainting_lsh_acc.wav" type="audio/wav">
                                        </audio>
                                        <p>Inpainting Method</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="interactive-demo">
            <h2>4. DIY in Real Time!</h2>
            <p>Try our interactive music generation tool where you can generate new accompaniments for given melody and chord conditions! Visit our Hugging Face demo to experiment with the model.</p>
            <p class="demo-link">
                <a href="https://huggingface.co/spaces/interactive-symbolic-music/InteractiveSymbolicMusicDemo" target="_blank">Try the Interactive Demo →</a>
            </p>
        </section>
    </div>
</body>
</html> 